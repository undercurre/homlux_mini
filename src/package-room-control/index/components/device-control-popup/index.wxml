<van-popup show="{{ show }}" position="bottom" round closeable catchtouchmove="true" bind:close="handleClose" safe-area-inset-bottom="{{false}}">
  <view class="w-750rpx bg-white flex-col flex items-center py-20rpx">
    <!-- tab -->
    <view class="flex justify-evenly w-686rpx mt-10rpx relative">
      <view class="flex-col-center" data-tab="light" wx:if="{{lightTab}}">
        <text class="mx-24rpx mt-16rpx tab-title">灯光</text>
      </view>
      <view class="flex-col-center" data-tab="switch" wx:if="{{switchTab}}">
        <text class="mx-24rpx mt-16rpx tab-title">开关</text>
      </view>
      <view class="flex-col-center" data-tab="curtain" wx:if="{{curtainTab}}">
        <text class="mx-24rpx mt-16rpx tab-title">窗帘</text>
      </view>
      <!-- 设置、关闭按钮 -->
      <view class="absolute left-20rpx top-16rpx" bind:tap="toDetail">
        <image class="w-48 h-48" src="/assets/img/home-manage/setting.png"></image>
      </view>
    </view>
    <!-- tab内容 -->
    <view class="flex flex-col items-center flex-1 pt-10rpx">
      <!-- 灯光控制 -->
      <view class="flex flex-col w-750rpx mb-22rpx" wx:if="{{tab==='light'}}">
        <text class="text-32rpx mt-70rpx ml-48rpx {{lightStatus.OnOff ? 'text-black-59' : 'text-hex-a2a2a2'}}">亮度 | {{lightInfoInner.Level}}%</text>
        <view class="px-48rpx pt-28rpx">
          <mz-slider catch:tap="sliderTap" catch:slideEnd="handleLevelChange" catch:slideChange="handleLevelDrag" disabled="{{!lightStatus.OnOff}}" value="{{lightInfoInner.Level}}" min="{{1}}" active-color="linear-gradient(90deg, rgba(80,127,255,0.8) 5%, rgba(116,153,255,0.18) 100%)"> </mz-slider>
        </view>

        <text class="text-32rpx mt-66rpx ml-48rpx {{lightStatus.OnOff ? 'text-black-59' : 'text-hex-a2a2a2'}}">色温 | {{colorTempK}}K</text>
        <view class="px-48rpx pt-28rpx">
          <mz-slider catch:tap="sliderTap" catch:slideEnd="handleColorTempChange" catch:slideChange="handleColorTempDrag" disabled="{{!lightStatus.OnOff}}" value="{{lightInfoInner.ColorTemp}}" use-button-slot custom-class="slider-color-temp-bar" active-color="rgba(0,0,0,0)">
            <view slot="button" class="slider-button" />
          </mz-slider>
        </view>
      </view>
      <!-- 开关控制 -->
      <view wx:if="{{tab==='switch'}}" class="flex flex-col w-750rpx flex-center">
        <view class="link-switch h-146rpx w-686rpx flex-center mt-32rpx" data-type="switch" bindtap="handleSelectLinkPopupConfirm">
          <view class="w-160rpx flex-center">
            <image src="/package-room-control/assets/img/link-switch.png" class="w-146rpx h-146rpx" />
          </view>
          <view class="flex-1 flex flex-col item-center">
            <text class="text-hex-373cdf text-32rpx font-medium">关联智能开关</text>
            <text class="text-hex-373cdf text-22rpx opacity-80 mt-12rpx">实现双控或多控功能</text>
          </view>
          <view class="mr-42rpx flex-center">
            <text class="text-black-tips text-28rpx leading-none">{{linkType==='switch' ? '已关联' : ''}}</text>
            <image src="/assets/img/base/arrow-right.png" class="w-32rpx h-32rpx" />
          </view>
        </view>
        <view class="link-light h-146rpx w-686rpx flex-center mt-24rpx" data-type="light" bindtap="handleSelectLinkPopupConfirm">
          <view class="w-160rpx flex-center">
            <image src="/package-room-control/assets/img/link-light.png" class="w-146rpx h-146rpx" />
          </view>
          <view class="flex-1 flex flex-col item-center">
            <text class="text-hex-de7e28 text-32rpx font-medium">关联智能灯</text>
            <text class="text-hex-de7e28 text-22rpx opacity-80 mt-12rpx">实现单灯或灯组的开关功能</text>
          </view>
          <view class="mr-42rpx flex-center">
            <text class="text-black-tips text-28rpx leading-none">{{linkType==='light' ? '已关联' : ''}}</text>
            <image src="/assets/img/base/arrow-right.png" class="w-32rpx h-32rpx" />
          </view>
        </view>
        <view class="link-scene h-146rpx w-686rpx flex-center mt-24rpx" data-type="scene" bindtap="handleSelectLinkPopupConfirm">
          <view class="w-160rpx flex-center">
            <image src="/package-room-control/assets/img/link-scene.png" class="w-146rpx h-146rpx" />
          </view>
          <view class="flex-1 flex flex-col item-center">
            <text class="text-hex-1454ae text-32rpx font-medium">关联场景</text>
            <text class="text-hex-1454ae text-22rpx opacity-80 mt-12rpx">实现智能场景的控制功能</text>
          </view>
          <view class="mr-42rpx flex-center">
            <text class="text-black-tips text-28rpx leading-none">{{linkType==='scene' ? '已关联' : ''}}</text>
            <image src="/assets/img/base/arrow-right.png" class="w-32rpx h-32rpx" />
          </view>
        </view>
      </view>
      <!-- 窗帘控制 -->
      <view wx:if="{{tab==='curtain'}}" class="w-full h-full flex-col-center">
        <curtain-slider class="mt-56rpx" value="{{curtainInfo.position}}" catch:change="changeCurtain" catch:slideEnd="changeCurtain"></curtain-slider>
        <view class="flex flex-row justify-evenly rounded-24rpx bg-hex-eef2f7 w-686rpx h-80rpx items-center mt-56rpx">
          <text catch:tap="openCurtain" class="text-32 text-hex-1e2c46 px-50rpx h-80rpx leading-80rpx rounded-24rpx btn-effect">全开</text>
          <view class="w-2rpx h-40rpx bg-hex-ddd"></view>
          <text catch:tap="pauseCurtain" class="text-32 text-hex-1e2c46 px-50rpx h-80rpx leading-80rpx rounded-24rpx btn-effect">暂停</text>
          <view class="w-2rpx h-40rpx bg-hex-ddd"></view>
          <text catch:tap="closeCurtain" class="text-32 text-hex-1e2c46 px-50rpx h-80rpx leading-80rpx rounded-24rpx btn-effect">全关</text>
        </view>
      </view>
    </view>
  </view>

  <view class="h-64rpx"></view>
</van-popup>

<!-- 关联列表（场景列表 or 设备列表）弹窗 -->
<select-card-popup show="{{showLinkPopup}}" title="{{selectCardPopupTitle}}" list="{{list}}" selectList="{{linkSelectList}}" cardType="{{selectLinkType}}" catch:close="handleLinkPopupClose" catch:select="handleLinkSelect" catch:confirm="handleLinkPopupConfirm" catch:cancel="handleLinkPopupReturn" />

<van-toast id="van-toast" />
<van-dialog id="van-dialog" confirm-button-color="#27282A" cancel-button-color="#27282A" />