<wxs module="wxs" src="./index.wxs"></wxs>
<view wx:if="{{isRender}}" change:info="{{wxs.infoObserver}}" info="{{info}}" id="popup" class="fixed z-200 left-0 w-750rpx h-716rpx opacity-0" bindtap="handlePopup" bindtouchstart="handleTouchStart" catchtouchmove="handleTouchMove">
  <!-- <view class="h-60rpx w-750rpx flex-center" style="opacity: {{popup ? 0:1}};">
    <image class="mb-36rpx w-76rpx h-24rpx" src="/assets/img/base/popup-arrow.png"></image>
  </view> -->
  <view class="popup-shadow w-750rpx h-716rpx rounded-t-64rpx bg-white flex-col flex items-center">
    <!-- <view class="flex-center mt-28rpx">
      <image class="w-60rpx h-20rpx arrow-{{popup ? 'down' : 'up'}}" src="/assets/img/base/popup-down.png"></image>
    </view> -->
    <view class="flex-center mt-28rpx h-20rpx">
      <view class="w-76rpx h-8rpx bg-black-tips rounded-999"></view>
    </view>
    <!-- tab -->
    <view class="flex justify-evenly w-686rpx">
      <view class="flex-col-center" data-tab="light" bindtap="handleTabTap" wx:if="{{lightTab}}">
        <text class="mt-34rpx mx-24rpx {{tab === 'light' ? 'tab-title-check' : 'tab-title-uncheck'}}">灯光</text>
        <view class="w-42rpx mb-20rpx h-8rpx mt-4rpx bg-blue rounded-999 {{tab === 'light' ? 'opacity-100' : 'opacity-0'}}"></view>
      </view>
      <view class="flex-col-center" data-tab="switch" bindtap="handleTabTap" wx:if="{{switchTab}}">
        <text class="mt-34rpx mx-24rpx {{tab === 'switch' ? 'tab-title-check' : 'tab-title-uncheck'}}">开关</text>
        <view class="w-42rpx mb-20rpx h-8rpx mt-4rpx bg-blue rounded-999 {{tab === 'switch' ? 'opacity-100' : 'opacity-0'}}"></view>
      </view>
      <view class="flex-col-center" data-tab="curtain" bindtap="handleTabTap" wx:if="{{curtainTab}}">
        <text class="mt-34rpx mx-24rpx {{tab === 'curtain' ? 'tab-title-check' : 'tab-title-uncheck'}}">窗帘</text>
        <view class="w-42rpx mb-20rpx h-8rpx mt-4rpx bg-blue rounded-999 {{tab === 'curtain' ? 'opacity-100' : 'opacity-0'}}"></view>
      </view>
    </view>
    <!-- tab内容 -->
    <view class="flex flex-col items-center flex-1">
      <view class="h-2rpx w-750rpx bg-hex-eee"></view>
      <!-- 灯光控制 -->
      <view class="flex flex-col w-750rpx" wx:if="{{tab==='light'}}">
        <text class="text-32rpx text-black-59 mt-37rpx ml-64rpx">亮度 | {{lightInfoInner.Level}}%</text>
        <view class="px-64rpx">
          <view class="h-32rpx"></view>
          <van-slider data-type-="level" bind:change="handleLevelChange" bind:drag="handleLevelDrag" bind:drag-end="handleLevelDragEnd" value="{{lightInfoInner.Level}}" min="{{1}}" use-button-slot custom-class="slider-brightness-bar" active-color="rgba(0,0,0,0)" bar-height="24rpx">
            <image slot="button" src="/assets/img/device-control/btn.png" class="w-88rpx h-88rpx mt-6rpx" />
          </van-slider>
          <view class="h-32rpx"></view>
        </view>
        <text class="text-32rpx text-black-59 mt-50rpx ml-64rpx">色温 | {{colorTempK}}K</text>
        <view class="px-64rpx">
          <view class="h-32rpx"></view>
          <van-slider data-type-="colorTemp" bind:change="handleColorTempChange" bind:drag="handleColorTempDrag" bind:drag-end="handleColorTempDragEnd" value="{{lightInfoInner.ColorTemp}}" use-button-slot custom-class="slider-color-temp-bar" active-color="rgba(0,0,0,0)" bar-height="24rpx">
            <image slot="button" src="/assets/img/device-control/btn.png" class="w-88rpx h-88rpx mt-6rpx" />
          </van-slider>
          <view class="h-32rpx"></view>
        </view>
      </view>
      <!-- 开关控制 -->
      <view wx:if="{{tab==='switch'}}" class="flex flex-col w-750rpx">
        <view class="h-22rpx"></view>
        <van-cell-group inset wx:if="{{!isSelectMultiSwitch}}">
          <van-cell border="{{false}}" is-link title="模式设置" value="{{currentLinkTypeDesc}}" custom-class="switch-cell" bind:click="handleSelectLinkPopup"></van-cell>
        </van-cell-group>
        <!-- <van-cell-group inset wx:if="{{!isSelectMultiSwitch}}">
          <van-cell clickable custom-class="switch-cell" data-link="switch" bind:click="handleLinkPopup">
            <view class="flex flex-col items-start">
              <text class="text-32rpx text-black-2a font-medium h-44rpx">关联智能开关</text>
              <text class="text-26rpx text-black-tips font-normal leading-none mt-12rpx mb-12rpx">通过开关触发场景</text>
            </view>
            <view slot="right-icon" class="h-90rpx flex-center">
              <svg-icon color="#555659" name="icon-park:right" width="48rpx" height="48rpx"></svg-icon>
            </view>
          </van-cell>
        </van-cell-group>
        <van-cell-group inset wx:if="{{!isSelectMultiSwitch}}">
          <van-cell clickable custom-class="switch-cell" data-link="light" bind:click="handleLinkPopup">
            <view class="flex flex-col items-start">
              <text class="text-32rpx text-black-2a font-medium h-44rpx">关联智能灯</text>
              <text class="text-26rpx text-black-tips font-normal leading-none mt-12rpx mb-12rpx">与关联的智能灯保持相同开关状态</text>
            </view>
            <view slot="right-icon" class="h-90rpx flex-center">
              <svg-icon color="#555659" name="icon-park:right" width="48rpx" height="48rpx"></svg-icon>
            </view>
          </van-cell>
        </van-cell-group>
        <van-cell-group inset wx:if="{{!isSelectMultiSwitch}}">
          <van-cell center clickable custom-class="switch-cell" data-link="scene" bind:click="handleLinkPopup">
            <view class="flex flex-col items-start">
              <text class="text-32rpx text-black-2a font-medium h-44rpx">关联场景</text>
              <text class="text-26rpx text-black-tips font-normal leading-none mt-12rpx mb-12rpx">关联后，可通过开关执行场景</text>
            </view>
            <svg-icon slot="right-icon" color="#555659" name="icon-park:right" width="48rpx" height="48rpx"></svg-icon>
          </van-cell>
        </van-cell-group> -->
      </view>
      <!-- 窗帘控制 -->
      <view wx:if="{{tab==='curtain'}}" class="w-full h-full flex-center">
        <text class="text-32rpx text-black-59">50%</text>
        <view class="w-496rpx h-368rpx relative">
          <image src="/assets/img/device-control/curtain-bg.png" class="w-496rpx h-368rpx" />
          <image src="/assets/img/device-control/curtain.png" class="w-213rpx h-300rpx absolute left-20rpx top-50rpx" />
          <image src="/assets/img/device-control/curtain-opener.png" class="w-80rpx h-80rpx absolute left-148rpx top-144rpx" />
          <image src="/assets/img/device-control/curtain.png" class="w-213rpx h-300rpx absolute right-20rpx top-50rpx" />
          <image src="/assets/img/device-control/curtain-opener.png" class="w-80rpx h-80rpx absolute right-148rpx top-144rpx" style="transform: scaleX(-1)" />
        </view>
        <text class="text-32rpx text-black-59">50%</text>
      </view>
    </view>
    <!-- 全开全关 -->
    <view class="flex items-center justify-evenly mt-46rpx bg-hex-f0f0f0 w-686rpx h-88rpx rounded-24rpx mb-64rpx">
      <view class="flex-1 flex-center relative h-88rpx" bindtap="handleAllOn">
        <text class="text-32rpx text-hex-1e2c46">全开</text>
        <view wx:if="{{allOnPress}}" class="absolute w-full h-full left-0 top-0 flex-center opacity-0 rounded-24rpx btn-press">
          <text class="text-32rpx text-hex-fff">全开</text>
        </view>
      </view>
      <view class="w-2rpx h-43rpx bg-hex-e7e7e7"></view>
      <view class="flex-1 flex-center relative h-88rpx" bindtap="handleAllOff">
        <text class="text-32rpx text-hex-1e2c46">全关</text>
        <view wx:if="{{allOffPress}}" class="absolute w-full h-full left-0 top-0 flex-center opacity-0 rounded-24rpx btn-press" id="all-off">
          <text class="text-32rpx text-hex-fff">全关</text>
        </view>
      </view>
    </view>
  </view>
</view>

<select-link-popup show="{{showSelectLinkPopup}}" linkType="{{linkType}}" bind:close="handleSelectLinkPopupClose" bind:confirm="handleSelectLinkPopupConfirm"></select-link-popup>
<link-popup has-return show="{{showLinkPopup}}" list="{{list}}" selectList="{{linkSelectList}}" linkType="{{linkType}}" bind:close="handleLinkPopupClose" bind:select="handleLinkSelect" bind:confirm="handleLinkPopupConfirm" bind:return="handleLinkPopupReturn" />

<van-toast id="van-toast" />